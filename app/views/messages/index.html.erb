<h1>Messages</h1>
<div id='popup'>
<table>
		<thead>
		<th>name</th>
		<th></th>
		</thead>
	<%@contacts.each do |user|%>
	<%unless user == current_user%>
		<tr>
		<td><%=user.name%></td>
			<td>
				<%=simple_form_for(@message) do |f|%>
					<%= hidden_field :message, :messageable_id, :value => user.id %>
					<%= hidden_field :message, :messageable_type, :value => User.name %>
					<%= hidden_field :message, :user_id, :value => current_user.id %>
					<%= hidden_field :message, :message, :value =>current_user.name+ " started conversation with "+user.name %>
					<%=f.button :submit, {class: "btn btn-primary"} %>
				
				<%end%>
			
			</td>
			
		<%end%>
		</tr>
	<%end%>
	
	</table>

	<button onclick="$('#popup').hide();">Close</button>

</div>
<table class="table">
<thead>
<th>name </th>


</thead>
<tbody>
<% @users.each do |user|%>
<p><%@temp=Message.where("user_id = ? and messageable_id=?",user.messageable_id,user.user_id).select(:user_id,:messageable_id).distinct.size%></p>
<% if @temp == 2 %>
	<%if current_user.id == user.messageable_id%>
		<%@user = User.find(user.user_id)%>
	<%else%>
		<%next%>
	<%end%>
<% elsif current_user.id == user.messageable_id%>
	<%@user = User.find(user.user_id)%>
<%else%>
	<%@user = User.find(user.messageable_id)%>
<%end%>
<tr>
<<<<<<< HEAD
	
	<td><%= link_to @user.name, new_message_path({messageable_type: User.name, messageable_id: @user.id}) %></td>
=======
	<td><%=@user.name%> </td>
	<td><%= link_to 'View Message', new_message_path({messageable_type: User.name, messageable_id: @user.id}) %></td>	
>>>>>>> userForward
</tr>

<%end%>
	</tbody>
</table>
<button onclick="$('#popup').show();" class="btn btn-primary">Start Conversation</button>
